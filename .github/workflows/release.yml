on:
  push:
    tags:
    - 'v*'

name: Make Relase
jobs:
  alpine:
    name: Build APK
    runs-on: ubuntu-latest
    steps:
    - name: Checkout source code
      uses: actions/checkout@v2
    - name: Alpine Build APK
      uses: KalleDK/actions-abuild@v0.0.2
      with:
        abuild_packager: Kalle M. Aagaard <alpine@k-moeller.dk>
        abuild_prefix: ./alpine
        abuild_pkg_ver: ${{ github.ref_name }}
        abuild_pkg_rel: 1
        abuild_key_name: alpine@k-moeller.dk-62068d1b
        abuild_key: ${{ secrets.ABUILD_KEY }}
        abuild_key_pub: ${{ secrets.ABUILD_KEY_PUB }}
    - name: Release
      uses: softprops/action-gh-release@v1
      if: startsWith(github.ref, 'refs/tags/')
      with:
        files: |
          ${{ github.workspace }}/packages/workspace/x86_64/*.apk
          